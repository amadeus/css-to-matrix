!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("matrix-utilities",[],b):a["matrix-utilities"]=b()}(this,function(){var a;return a=function(){var a;return a={add:function(a,b){var c,d,e,f,g,h,i,j,k;if(a.length!==b.length)throw new Error("Matrix y dimensions do not match");for(e=[],c=h=0,j=a.length;j>h;c=++h){if(f=a[c],f.length!==b[c].length)throw new Error("Matrix x dimensions do not match on row "+(c+1));for(e[c]=[],d=i=0,k=f.length;k>i;d=++i)g=f[d],e[c][d]=g+b[c][d]}return e},multiply:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;if(a[0].length!==b.length)throw new Error("Matrix 1's row count should equal matrix 2's column count");for(h=a[0].length,f=[],c=k=0,m=b.length;m>k;c=++k)for(g=b[c],f[c]=[],d=l=0,n=g.length;n>l;d=++l){for(j=g[d],e=h,i=0;e--;)i+=a[c][e]*b[e][d];f[c][d]=i}return f},flip:function(a){var b,c,d,e,f,g,h,i,j;for(d=[],b=g=0,i=a.length;i>g;b=++g)for(e=a[b],c=h=0,j=e.length;j>h;c=++h)f=e[c],(d[c]||(d[c]=[]))[b]=f;return d},to2d:function(a){return[[a[0][0]||1,a[0][1]||0,a[0][3]||0],[a[1][0]||0,a[1][1]||1,a[1][3]||0]]},to3d:function(a){return[[a[0][0]||1,a[0][1]||0,0,a[0][2]||0],[a[1][0]||0,a[1][1]||1,0,a[1][2]||0],[0,0,1,0],[0,0,0,1]]},Identity:function(){return[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]}}}()}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("transform-to-matrix",[],b):a["transform-to-matrix"]=b()}(this,function(){var a;return a=function(){var a;return a={perspective:function(a){return[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,-1/a,1]]},rotate:function(b){return a.rotateZ(b)},rotateX:function(b){return a.rotate3d(1,0,0,b)},rotateY:function(b){return a.rotate3d(0,1,0,b)},rotateZ:function(a){var b,c;return b=Math.cos(a),c=Math.sin(a),[[b,-c,0],[c,b,0]]},rotate3d:function(a,b,c,d){var e,f,g,h,i;return i=a*a+b*b+c*c,e=Math.cos(d),g=Math.sin(d),f=1-e,h=Math.sqrt(i)*g,[[(a*a+(b*b+c*c)*e)/i,(a*b*f-c*h)/i,(a*c*f+b*h)/i,0],[(a*b*f+c*h)/i,(b*b+(a*a+c*c)*e)/i,(b*c*f-a*h)/i,0],[(a*c*f-b*h)/i,(b*c*f+a*h)/i,(c*c+(a*a+b*b)*e)/i,0],[0,0,0,1]]},scale:function(a,b){return[[a,0,0],[0,b,0]]},scaleX:function(b){return a.scale(b,1)},scaleY:function(b){return a.scale(1,b)},scaleZ:function(b){return a.scale3d(1,1,b)},scale3d:function(a,b,c){return[[a,0,0,0],[0,b,0,0],[0,0,c,0],[0,0,0,1]]},skew:function(a,b){return[[1,Math.tan(a),0],[Math.tan(b),1,0]]},skewX:function(a){return[[1,Math.tan(a),0],[0,1,0]]},skewY:function(a){return[[1,0,0],[Math.tan(a),1,0]]},translate:function(a,b){return[[1,0,a],[0,1,b]]},translateX:function(b){return a.translate(b,0)},translateY:function(b){return a.translate(0,b)},translateZ:function(b){return a.translate3d(0,0,b)},translate3d:function(a,b,c){return[[1,0,0,a],[0,1,0,b],[0,0,1,c],[0,0,0,1]]}}}()}),function(a,b){"object"==typeof exports?module.exports=b(require("transform-to-matrix"),require("matrix-utilities")):"function"==typeof define&&define.amd?define("matrixee",["transform-to-matrix","matrix-utilities"],b):a.Matrixee=b(a["transform-to-matrix"],a["matrix-utilities"])}(this,function(a,b){var c=function(a){if("string"==typeof a){var b=parseFloat(a,10),c=a.indexOf("deg")>-1;return c&&(b*=Math.PI/180),b}return a},d=Object.prototype.toString,e=function(a){this.matrix=new b.Identity,this.transformations={perspective:new b.Identity,rotate:new b.Identity,scale:new b.Identity,skew:new b.Identity,translate:new b.Identity},a&&this.setMatrix(a)},f=/(.*matrix[\w]*\(| |\).*)/g;return e.prototype={setMatrix:function(a){if("[object Array]"!==d.call(a))throw new TypeError("expected parameter `data` to be an Array, but was given a "+d.call(a));if("[object Array]"!==d.call(a[0]))throw new TypeError("nested array expected.");if(a.length!==a[0].length)throw new Error("parent and child arrays must be the same length");if(a.length>4||a.length<3)throw new Error("must be a 3x3 or 4x4 matrix, was "+a.length+"x"+a[0].length);return 3===a.length&&e.from3x3to4x4(a),this.matrix=e.merge(this.matrix,a),this},setMatrixFromCSS:function(a){var b=e.getMatrixFromCSS(a);return this.setMatrix(b),this},getMatrix:function(){var a=e.clone(this.matrix),c=this.transformations;return a=b.multiply(a,c.perspective),a=b.multiply(a,c.translate),a=b.multiply(a,c.rotate),a=b.multiply(a,c.skew),a=b.multiply(a,c.scale)},getMatrixCSS:function(){return"matrix3d("+b.flip(this.getMatrix()).reduce(function(a,b){return a.push.apply(a,b),a},[]).join(",")+")"},rotate:function(a){return this.rotateZ(a)},rotateX:function(a){return this.rotate3d(1,0,0,a)},rotateY:function(a){return this.rotate3d(0,1,0,a)},rotateZ:function(a){return this.rotate3d(0,0,1,a)},scale:function(a,b){return this.scale3d(a,b)},scaleX:function(a){return this.scale3d(a)},scaleY:function(a){return this.scale3d(null,a)},scaleZ:function(a){return this.scale3d(null,null,a)},skewX:function(a){return this.skew(a)},skewY:function(a){return this.skew(null,a)},translate:function(a,b){return this.translate3d(a,b)},translateX:function(a){return this.translate3d(a)},translateY:function(a){return this.translate3d(null,a)},translateZ:function(a){return this.translate3d(null,null,a)},perspective:function(b){if(b||(b=0),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);return e.merge(this.transformations.perspective,a.perspective(b)),this},rotate3d:function(b,d,f,g){if(b||(b=0),d||(d=0),f||(f=0),g||(g=0),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if("number"!=typeof d)throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof d);if("number"!=typeof f)throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof f);return e.merge(this.transformations.rotate,a.rotate3d(b,d,f,c(g))),this},scale3d:function(b,c,d){if(b||0===b||(b=1),c||0===c||(c=1),d||0===d||(d=1),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if("number"!=typeof c)throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof c);if("number"!=typeof d)throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof d);return e.merge(this.transformations.scale,a.scale3d(b,c,d)),this},skew:function(d,f){return d||(d=0),f||(f=0),e.merge(this.transformations.skew,b.to3d(a.skew(c(d),c(f)))),this},translate3d:function(b,c,d){if(b||(b=0),c||(c=0),d||(d=0),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if("number"!=typeof c)throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof c);if("number"!=typeof d)throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof d);return e.merge(this.transformations.translate,a.translate3d(b,c,d)),this}},e.clone=function(a){var b,c,d=[];for(b=0;b<a.length;b++)for(d[b]=[],c=0;c<a[b].length;c++)d[b][c]=a[b][c]||0;return d},e.merge=function(a,b){var c,d;for(c=0;c<a.length;c++)for(d=0;d<a[c].length;d++)a[c][d]=b[c][d]||0;return a},e.from3x3to4x4=function(a){return a[0].push(0),a[1].push(0),a[2].push(0),a[3]=[0,0,0,1],a},e.getMatrixFromCSS=function(a){var c,d,e,g;if("none"===a||!a)return new b.Identity;if(a=a.replace(f,""),c=a.split(","),6!==c.length&&16!==c.length)throw new TypeError("invalid array parsed from string: "+a);for(6===c.length&&(c.splice(2,0,0,0),c.splice(6,0,0,0),c.push(1,0,0,0,0,1)),d=[],e=0;e<c.length/4;e++)for(d[e]=[],g=0;4>g;g++)d[e][g]=parseFloat(c[4*e+g]);return d=b.flip(d)},e});