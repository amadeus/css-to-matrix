!function(a,b){"object"==typeof exports?module.exports=b(require("transform-to-matrix"),require("matrix-utilities"),require("umodel")):"function"==typeof define&&define.amd?define("matrixee",["transform-to-matrix","matrix-utilities","umodel"],b):a.Matrixee=b(a["transform-to-matrix"],a["matrix-utilities"],a.umodel)}(this,function(a,b,c){function d(a){this.model=new c({matrix:new b.Identity,transformations:{perspective:new b.Identity,rotate:new b.Identity,scale:new b.Identity,skew:new b.Identity,translate:new b.Identity}}),a&&this.matrix(a)}var e={rad:function(a){if("string"==typeof a){var b=parseFloat(a,10),c=a.indexOf("deg")>-1;return c&&(b*=Math.PI/180),b}return a},extend:function(a,b){for(var c in b)a[c]=b[c];return a},fluent:function(a){return function(){return a.apply(this,arguments),this}},isNumber:function(a){return"number"==typeof a}};return e.extend(d.prototype,{matrix:function(a){if(null==a.length)throw new TypeError("expected parameter `data` to be an Array, but was given a "+typeof a);var b=a.length,c=b>0?b:0;if(4!==b||4!==c)throw new Error("expected parameter `data` to be a 4x4 matrix of arrays, but was given a "+b+"x"+c+" matrix");this.model.set("matrix",a)},getMatrix:function(){var a=this.model.get("matrix"),c=this.model.get("transformations");return a=b.multiply(a,c.perspective),a=b.multiply(a,c.translate),a=b.multiply(a,c.rotate),a=b.multiply(a,c.skew),a=b.multiply(a,c.scale),b.flip(a)},getMatrixCSS:function(){return"matrix3d("+this.getMatrix().reduce(function(a,b){return a.push.apply(a,b),a},[]).join(",")+")"},rotate:function(a){return this.rotateZ(a)},rotateX:function(a){return this.rotate3d(1,0,0,a)},rotateY:function(a){return this.rotate3d(0,1,0,a)},rotateZ:function(a){return this.rotate3d(0,0,1,a)},scale:function(a,b){return this.scale3d(a,b)},scaleX:function(a){return this.scale3d(a)},scaleY:function(a){return this.scale3d(null,a)},scaleZ:function(a){return this.scale3d(null,null,a)},skewX:function(a){return this.skew(a)},skewY:function(a){return this.skew(null,a)},translate:function(a,b){return this.translate3d(a,b)},translateX:function(a){return this.translate3d(a)},translateY:function(a){return this.translate3d(null,a)},translateZ:function(a){return this.translate3d(null,null,a)},perspective:e.fluent(function(b){if(null==b&&(b=0),!e.isNumber(b))throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);this.model.set("transformations/perspective",a.perspective(b))}),rotate3d:e.fluent(function(b,c,d,f){if(null==b&&(b=0),null==c&&(c=0),null==d&&(d=0),null==f&&(f=0),!e.isNumber(b))throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if(!e.isNumber(c))throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof c);if(!e.isNumber(d))throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof d);this.model.set("transformations/rotate",a.rotate3d(b,c,d,e.rad(f)))}),scale3d:e.fluent(function(b,c,d){if(null==b&&(b=1),null==c&&(c=1),null==d&&(d=1),!e.isNumber(b))throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if(!e.isNumber(c))throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof c);if(!e.isNumber(d))throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof d);this.model.set("transformations/scale",a.scale3d(b,c,d))}),skew:e.fluent(function(c,d){null==c&&(c=0),null==d&&(d=0),this.model.set("transformations/skew",b.to3d(a.skew(e.rad(c),e.rad(d))))}),translate3d:e.fluent(function(b,c,d){if(null==b&&(b=0),null==c&&(c=0),null==d&&(d=0),!e.isNumber(b))throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if(!e.isNumber(c))throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof c);if(!e.isNumber(d))throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof d);this.model.set("transformations/translate",a.translate3d(b,c,d))})}),d});