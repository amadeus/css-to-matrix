!function(a,b){"object"==typeof exports?module.exports=b(require("transform-to-matrix"),require("matrix-utilities")):"function"==typeof define&&define.amd?define("matrixee",["transform-to-matrix","matrix-utilities"],b):a.Matrixee=b(a["transform-to-matrix"],a["matrix-utilities"])}(this,function(a,b){var c=function(a){if("string"==typeof a){var b=parseFloat(a,10),c=a.indexOf("deg")>-1;return c&&(b*=Math.PI/180),b}return a},d=Object.prototype.toString,e=function(a){this.matrix=new b.Identity,this.transformations={perspective:new b.Identity,rotate:new b.Identity,scale:new b.Identity,skew:new b.Identity,translate:new b.Identity},a&&this.setMatrix(a)},f=/(.*matrix[\w]*\(| |\).*)/g;return e.prototype={setMatrix:function(a){if("[object Array]"!==d.call(a))throw new TypeError("expected parameter `data` to be an Array, but was given a "+d.call(a));if("[object Array]"!==d.call(a[0]))throw new TypeError("nested array expected.");if(a.length!==a[0].length)throw new Error("parent and child arrays must be the same length");if(a.length>4||a.length<3)throw new Error("must be a 3x3 or 4x4 matrix, was "+a.length+"x"+a[0].length);return 3===a.length&&e.from3x3to4x4(a),this.matrix=e.merge(this.matrix,a),this},setMatrixFromCSS:function(a){var b=e.getMatrixFromCSS(a);return this.setMatrix(b),this},getMatrix:function(){var a=e.clone(this.matrix),c=this.transformations;return a=b.multiply(a,c.perspective),a=b.multiply(a,c.translate),a=b.multiply(a,c.rotate),a=b.multiply(a,c.skew),a=b.multiply(a,c.scale)},getMatrixCSS:function(){return"matrix3d("+b.flip(this.getMatrix()).reduce(function(a,b){return a.push.apply(a,b),a},[]).join(",")+")"},rotate:function(a){return this.rotateZ(a)},rotateX:function(a){return this.rotate3d(1,0,0,a)},rotateY:function(a){return this.rotate3d(0,1,0,a)},rotateZ:function(a){return this.rotate3d(0,0,1,a)},scale:function(a,b){return this.scale3d(a,b)},scaleX:function(a){return this.scale3d(a)},scaleY:function(a){return this.scale3d(null,a)},scaleZ:function(a){return this.scale3d(null,null,a)},skewX:function(a){return this.skew(a)},skewY:function(a){return this.skew(null,a)},translate:function(a,b){return this.translate3d(a,b)},translateX:function(a){return this.translate3d(a)},translateY:function(a){return this.translate3d(null,a)},translateZ:function(a){return this.translate3d(null,null,a)},perspective:function(b){if(b||(b=0),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);return e.merge(this.transformations.perspective,a.perspective(b)),this},rotate3d:function(b,d,f,g){if(b||(b=0),d||(d=0),f||(f=0),g||(g=0),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if("number"!=typeof d)throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof d);if("number"!=typeof f)throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof f);return e.merge(this.transformations.rotate,a.rotate3d(b,d,f,c(g))),this},scale3d:function(b,c,d){if(b||0===b||(b=1),c||0===c||(c=1),d||0===d||(d=1),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if("number"!=typeof c)throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof c);if("number"!=typeof d)throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof d);return e.merge(this.transformations.scale,a.scale3d(b,c,d)),this},skew:function(d,f){return d||(d=0),f||(f=0),e.merge(this.transformations.skew,b.to3d(a.skew(c(d),c(f)))),this},translate3d:function(b,c,d){if(b||(b=0),c||(c=0),d||(d=0),"number"!=typeof b)throw new TypeError("expected parameter `x` to be a Number, but was given a "+typeof b);if("number"!=typeof c)throw new TypeError("expected parameter `y` to be a Number, but was given a "+typeof c);if("number"!=typeof d)throw new TypeError("expected parameter `z` to be a Number, but was given a "+typeof d);return e.merge(this.transformations.translate,a.translate3d(b,c,d)),this}},e.clone=function(a){var b,c,d=[];for(b=0;b<a.length;b++)for(d[b]=[],c=0;c<a[b].length;c++)d[b][c]=a[b][c]||0;return d},e.merge=function(a,b){var c,d;for(c=0;c<a.length;c++)for(d=0;d<a[c].length;d++)a[c][d]=b[c][d]||0;return a},e.from3x3to4x4=function(a){return a[0].push(0),a[1].push(0),a[2].push(0),a[3]=[0,0,0,1],a},e.getMatrixFromCSS=function(a){var c,d,e,g;if("none"===a||!a)return new b.Identity;if(a=a.replace(f,""),c=a.split(","),6!==c.length&&16!==c.length)throw new TypeError("invalid array parsed from string: "+a);for(6===c.length&&(c.splice(2,0,0,0),c.splice(6,0,0,0),c.push(1,0,0,0,0,1)),d=[],e=0;e<c.length/4;e++)for(d[e]=[],g=0;4>g;g++)d[e][g]=parseFloat(c[4*e+g]);return d=b.flip(d)},e});